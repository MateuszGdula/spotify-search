webpackJsonp([1],{"0XJ9":function(t,e){},"6P8F":function(t,e){},JrWG:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("/5sW"),n=s("woOf"),i=s.n(n),r=s("mtWM"),o=s.n(r);function l(t){return(document.cookie.match("(^|;) *"+t+"=([^;]*)")||"")[2]}var u=function(){return{isLoading:!1,noResults:!1,order:"bestMatch",albums:[],renderedAlbums:[],token:"undefined"!==l("accessToken")?l("accessToken"):""}},c={state:u(),getAuthorization:function(){if(!this.state.token){this.state.token=window.location.hash.substring(1).split("&")[0].split("=")[1];var t=new Date;if(t.setTime(t.getTime()+36e5),document.cookie="accessToken="+this.state.token+"; expires="+t.toGMTString()+";",window.location.hash="",!this.state.token){var e="localhost:8080"===location.host?"http://localhost:8080":"https://spotify-albums-search-a69bf.firebaseapp.com";window.location="https://accounts.spotify.com/authorize?client_id=46b07972174149b99f8e08d3e38d4aad&redirect_uri="+e+"&response_type=token"}}},getAlbums:function(t,e){var s=this;e&&i()(this.state,u()),this.state.isLoading=!0,o()({method:"get",url:t,headers:{Authorization:"Bearer "+this.state.token}}).then(function(t){var e=t.data.albums.items;0===e.length&&(s.state.noResults=!0),s.state.albums=s.state.albums.concat(e),s.state.isLoading=!1,null!=t.data.albums.next&&s.state.albums.length<300?s.getAlbums(t.data.albums.next,!1):(s.state.albums.forEach(function(t,e){t.spotifyOrderIndex=e}),s.renderAlbums())}).catch(function(t){400!==t.response.status&&401!==t.response.status||(s.state.token="",s.getAuthorization())})},renderAlbums:function(){this.state.renderedAlbums=this.state.renderedAlbums.concat(this.state.albums.slice(this.state.renderedAlbums.length,this.state.renderedAlbums.length+10))},sortAlbums:function(t){this.state.renderedAlbums=[],"name"===t?this.state.albums.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}):"date"===t?this.state.albums.sort(function(t,e){return Number(t.release_date.slice(0,4))-Number(e.release_date.slice(0,4))}):this.state.albums.sort(function(t,e){return t.spotifyOrderIndex-e.spotifyOrderIndex}),this.renderAlbums(10)}},d={name:"Form",data:function(){return{state:c.state}},computed:{requestURL:function(){return"https://api.spotify.com/v1/search?q="+encodeURIComponent(this.state.userText)+"&type=album&limit=50"}},methods:{sendRequest:function(){c.getAlbums(this.requestURL,!0)},sortAlbums:function(){c.sortAlbums(this.state.order)}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{ref:"form",staticClass:"form-albums",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.sendRequest(e)}}},[s("div",{staticClass:"input-group"},[s("span",{staticClass:"input-group-addon"},[t._v("Album:")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.state.userText,expression:"state.userText"}],staticClass:"form-input",attrs:{type:"text",placeholder:"...",required:""},domProps:{value:t.state.userText},on:{input:function(e){e.target.composing||t.$set(t.state,"userText",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn btn-primary input-group-btn"},[t._v("\n            Search\n        ")])]),t._v(" "),s("div",{staticClass:"form-group order-by"},[s("span",[t._v("Order by:")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.state.order,expression:"state.order"}],staticClass:"form-select order-by__select",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.state,"order",e.target.multiple?s:s[0])},t.sortAlbums]}},[s("option",{attrs:{value:"bestMatch"}},[t._v("best match")]),t._v(" "),s("option",{attrs:{value:"name"}},[t._v("album name")]),t._v(" "),s("option",{attrs:{value:"date"}},[t._v("release date")])])])])},staticRenderFns:[]};var h=s("VU/8")(d,m,!1,function(t){s("0XJ9")},"data-v-050fce72",null).exports,p={name:"SearchResultsListItem",data:function(){return{details:{pupularity:0,tracks:[]},displayDetails:!1,albumDetailsLoaded:!1}},props:{id:{type:String},img:{type:String,default:"http://photos1.blogger.com/blogger/3775/2528/320/COVER%20NOT%20AVAILABLE.jpg"},name:{type:String,default:"Album name is not available"},authors:{type:Array,default:[{name:"Artist name is not available"}]},date:{type:String,default:"Release date is not available"},totalTracks:{type:String,default:"Tracks number is not available"},token:{type:String}},computed:{fixedAuthors:function(){var t=this,e="";return this.authors.forEach(function(s,a){e+=s.name,e+=void 0===t.authors[a+1]?"":", "}),e},albumTotalTime:function(){var t=0;return this.details.tracks.forEach(function(e){t+=e.duration_ms}),t}},methods:{getAlbumDetails:function(){var t=this;this.albumDetailsLoaded||o()({method:"get",url:"https://api.spotify.com/v1/albums/"+this.id,headers:{Authorization:"Bearer "+this.token}}).then(function(e){t.details.popularity=e.data.popularity.toString(),t.details.tracks=e.data.tracks.items,t.albumDetailsLoaded=!0}).catch(function(t){400!==t.response.status&&401!==t.response.status||location.reload()})},showOrHideDetails:function(){this.displayDetails=!this.displayDetails},msToMinAndSec:function(t){var e=Math.floor(t/6e4),s=(t%6e4/1e3).toFixed(0);return e+":"+(s<10?"0":"")+s}}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"listItem__wrapper"},[s("div",{staticClass:"listItem__image-wrapper"},[s("img",{staticClass:"listItem__image",attrs:{src:t.img}})]),t._v(" "),s("div",{staticClass:"listItem__info-wrapper"},[s("h2",{staticClass:"listItem__album-name"},[t._v(t._s(t.name))]),t._v(" "),s("ul",{staticClass:"listItem__info"},[s("li",[t._v("Author"+t._s(t.authors.length>1?"s":"")+": "+t._s(t.fixedAuthors))]),t._v(" "),s("li",[t._v("Release date: "+t._s(t.date))]),t._v(" "),s("li",[t._v("Total tracks: "+t._s(t.totalTracks))])]),t._v(" "),s("h3",{staticClass:"listItem__details-header",on:{click:function(e){t.getAlbumDetails(),t.showOrHideDetails()}}},[t._v("\n            "+t._s(t.displayDetails&&t.albumDetailsLoaded?"- Less":"+ More")+" information\n        ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.displayDetails&&t.albumDetailsLoaded,expression:"displayDetails && albumDetailsLoaded"}],staticClass:"listItem__details-wrapper"},[s("ul",{staticClass:"listItem__details"},[s("li",[t._v("Popularity: "+t._s(t.details.popularity))]),t._v(" "),s("li",[t._v("Total time: "+t._s(t.msToMinAndSec(t.albumTotalTime)))])]),t._v(" "),s("h4",{staticClass:"listItem__tracks-header"},[t._v("Tracks list:")]),t._v(" "),s("ul",{staticClass:"listItem__tracks-list"},t._l(t.details.tracks,function(e,a){return s("li",{key:e.uri},[t._v("\n                    "+t._s(a+1)+". "+t._s(e.name)),s("span",[t._v(" "+t._s(t.msToMinAndSec(e.duration_ms)))])])}),0)])])])},staticRenderFns:[]};var _={name:"SearchResults",components:{SearchResultsListItem:s("VU/8")(p,f,!1,function(t){s("JrWG")},"data-v-031ec8a9",null).exports},data:function(){return{state:c.state}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"searchResults"},[s("ul",{staticClass:"searchResults__list"},t._l(t.state.renderedAlbums,function(e){return s("SearchResultsListItem",{key:e.uri,attrs:{id:e.id,img:e.images[1].url,name:e.name,authors:e.artists,date:e.release_date,totalTracks:e.total_tracks.toString(),token:t.state.token}})}),1),t._v(" "),t.state.isLoading?s("div",{staticClass:"loading loading-lg"}):t._e(),t._v(" "),t.state.noResults?s("div",{staticClass:"noResults"},[s("p",[t._v("No results found for: "+t._s(t.state.userText))])]):t._e()])},staticRenderFns:[]};var b={name:"App",components:{Form:h,SearchResults:s("VU/8")(_,v,!1,function(t){s("oC9w")},"data-v-57452b32",null).exports},data:function(){return{state:c.state}},methods:{renderAlbums:function(){Math.floor(window.innerHeight+window.scrollY)+1>=document.body.offsetHeight&&c.renderAlbums()}},mounted:function(){c.getAuthorization(),window.addEventListener("scroll",this.renderAlbums)},beforeDestroy:function(){window.removeEventListener("scroll",this.renderAlbums)}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("h1",{staticClass:"appHeader"},[this._v("Spotify albums search")]),this._v(" "),e("Form"),this._v(" "),e("SearchResults")],1)},staticRenderFns:[]};var A=s("VU/8")(b,g,!1,function(t){s("6P8F")},"data-v-710f7912",null).exports;a.a.config.productionTip=!1,new a.a({el:"#app",render:function(t){return t(A)}})},oC9w:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.09eddbfa88d0c5c4672e.js.map