webpackJsonp([1],{"+9c6":function(t,e){},"/Yc6":function(t,e){},DwFz:function(t,e){},Ebsz:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("/5sW"),r=s("woOf"),i=s.n(r),n=s("mtWM"),o=s.n(n);function l(t){return(document.cookie.match("(^|;) *"+t+"=([^;]*)")||"")[2]}var u=function(){return{isLoading:!1,noResults:!1,order:"bestMatch",albums:[],renderedAlbums:[],token:"undefined"!==l("accessToken")?l("accessToken"):"",displayRedirection:!1}},c={state:u(),getAuthorization:function(){if(!this.state.token){this.state.token=window.location.hash.substring(1).split("&")[0].split("=")[1];var t=new Date;if(t.setTime(t.getTime()+36e5),document.cookie="accessToken="+this.state.token+"; expires="+t.toGMTString()+";",window.location.hash="",!this.state.token){var e="localhost:8080"===location.host?"http://localhost:8080":"https://spotify-albums-search-a69bf.firebaseapp.com";this.state.displayRedirection=!0,setTimeout(function(){window.location="https://accounts.spotify.com/authorize?client_id=46b07972174149b99f8e08d3e38d4aad&redirect_uri="+e+"&response_type=token"},2e3)}}},getAlbums:function(t,e){var s=this;e&&i()(this.state,u()),this.state.isLoading=!0,o()({method:"get",url:t,headers:{Authorization:"Bearer "+this.state.token}}).then(function(t){var e=t.data.albums.items;0===e.length&&(s.state.noResults=!0),s.state.albums=s.state.albums.concat(e),s.state.isLoading=!1,null!=t.data.albums.next&&s.state.albums.length<300?s.getAlbums(t.data.albums.next,!1):(s.state.albums.forEach(function(t,e){t.spotifyOrderIndex=e}),s.renderAlbums())}).catch(function(t){400!==t.response.status&&401!==t.response.status||(s.state.token="",s.getAuthorization())})},renderAlbums:function(){this.state.renderedAlbums=this.state.renderedAlbums.concat(this.state.albums.slice(this.state.renderedAlbums.length,this.state.renderedAlbums.length+10))},sortAlbums:function(t){this.state.renderedAlbums=[],"name"===t?this.state.albums.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}):"date"===t?this.state.albums.sort(function(t,e){return Number(t.release_date.slice(0,4))-Number(e.release_date.slice(0,4))}):this.state.albums.sort(function(t,e){return t.spotifyOrderIndex-e.spotifyOrderIndex}),this.renderAlbums()}},d={name:"Form",data:function(){return{state:c.state}},computed:{requestURL:function(){return"https://api.spotify.com/v1/search?q="+encodeURIComponent(this.state.userText)+"&type=album&limit=50"}},methods:{sendRequest:function(){c.getAlbums(this.requestURL,!0)},sortAlbums:function(){c.sortAlbums(this.state.order)}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{ref:"form",staticClass:"form__wrapper",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.sendRequest(e)}}},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.state.userText,expression:"state.userText"}],staticClass:"form-input",attrs:{type:"text",placeholder:"Enter album or artist name",required:""},domProps:{value:t.state.userText},on:{input:function(e){e.target.composing||t.$set(t.state,"userText",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn btn-primary input-group-btn form__button"},[t._v("\n            Search\n        ")])]),t._v(" "),s("div",{staticClass:"form-group form__order-by"},[s("span",[t._v("Order by:")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.state.order,expression:"state.order"}],staticClass:"form-select form__select",on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.state,"order",e.target.multiple?s:s[0])},t.sortAlbums]}},[s("option",{attrs:{value:"bestMatch"}},[t._v("best match")]),t._v(" "),s("option",{attrs:{value:"name"}},[t._v("album name")]),t._v(" "),s("option",{attrs:{value:"date"}},[t._v("release date")])])])])},staticRenderFns:[]};var m=s("VU/8")(d,p,!1,function(t){s("/Yc6")},"data-v-1f72a3a7",null).exports,h={name:"AudioPlayer",props:{src:{type:String,required:!0}},data:function(){return{isPlayed:!1}},methods:{clickHandler:function(){this.isPlayed?this.pause():this.play()},play:function(){document.querySelectorAll("audio").forEach(function(t){t.pause()}),this.$refs.audio.play(),this.isPlayed=!0},pause:function(){this.$refs.audio.pause(),this.isPlayed=!1}},mounted:function(){this.$refs.audio.addEventListener("pause",this.pause,!1)},beforeDestroy:function(){this.$refs.audio.removeEventListener("pause",this.pause)}},f={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"player__wrapper"},[s("div",{ref:"playerBtn",staticClass:"player__btn",class:{"play-btn":!t.isPlayed,"pause-btn":t.isPlayed},attrs:{tabindex:"0"},on:{click:t.clickHandler,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$refs.playerBtn.click()}}}),t._v(" "),s("audio",{ref:"audio"},[s("source",{attrs:{src:t.src}})])])},staticRenderFns:[]};var _={name:"ListItemDetails",components:{AudioPlayer:s("VU/8")(h,f,!1,function(t){s("Rrl4")},null,null).exports},props:{displayDetails:{type:Boolean,default:!1},popularity:{type:String,default:"0"},tracks:{type:Array,default:[]}},computed:{albumTotalTime:function(){var t=0;return this.tracks.forEach(function(e){t+=e.duration_ms}),t}},methods:{msToMinAndSec:function(t){var e=Math.floor(t/6e4),s=(t%6e4/1e3).toFixed(0);return e+":"+(s<10?"0":"")+s}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("transition",{attrs:{name:"fade",appear:""}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.displayDetails,expression:"displayDetails"}],staticClass:"listItem__details-wrapper"},[s("ul",{staticClass:"listItem__details"},[s("li",[t._v("Popularity: "+t._s(t.popularity))]),t._v(" "),s("li",[t._v("Total time: "+t._s(t.msToMinAndSec(t.albumTotalTime)))])]),t._v(" "),s("h4",{staticClass:"listItem__tracks-header"},[t._v("Tracks list:")]),t._v(" "),s("ul",{staticClass:"listItem__tracks-list"},t._l(t.tracks,function(e,a){return s("li",{key:e.uri},[s("div",{staticClass:"listItem__track-name"},[t._v("\n                    "+t._s(a+1)+". "+t._s(e.name)),s("span",[t._v(" "+t._s(t.msToMinAndSec(e.duration_ms)))])]),t._v(" "),e.preview_url?s("AudioPlayer",{attrs:{src:e.preview_url}}):t._e()],1)}),0)])])},staticRenderFns:[]};var y={name:"SearchResultsListItem",components:{ListItemDetails:s("VU/8")(_,v,!1,function(t){s("ydsG")},"data-v-02a19142",null).exports},data:function(){return{displayDetails:!1,albumDetailsLoaded:!1,pupularity:"0",tracks:[]}},props:{id:{type:String},img:{type:String,default:"http://photos1.blogger.com/blogger/3775/2528/320/COVER%20NOT%20AVAILABLE.jpg"},name:{type:String,default:"Album name is not available"},authors:{type:Array,default:[{name:"Artist name is not available"}]},date:{type:String,default:"Release date is not available"},totalTracks:{type:String,default:"Tracks number is not available"},token:{type:String}},computed:{fixedAuthors:function(){var t=this,e="";return this.authors.forEach(function(s,a){e+=s.name,e+=void 0===t.authors[a+1]?"":", "}),e}},methods:{getAlbumDetails:function(){var t=this;this.albumDetailsLoaded||o()({method:"get",url:"https://api.spotify.com/v1/albums/"+this.id,headers:{Authorization:"Bearer "+this.token}}).then(function(e){t.popularity=e.data.popularity.toString(),t.tracks=e.data.tracks.items,t.albumDetailsLoaded=!0}).catch(function(t){400!==t.response.status&&401!==t.response.status||location.reload()})}}},b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"listItem__wrapper"},[s("div",{staticClass:"listItem__image-wrapper"},[s("img",{staticClass:"listItem__image",attrs:{src:t.img}})]),t._v(" "),s("div",{staticClass:"listItem__info-wrapper"},[s("h2",{staticClass:"listItem__album-name"},[t._v(t._s(t.name))]),t._v(" "),s("ul",{staticClass:"listItem__info"},[s("li",[t._v("Author"+t._s(t.authors.length>1?"s":"")+": "+t._s(t.fixedAuthors))]),t._v(" "),s("li",[t._v("Release date: "+t._s(t.date))]),t._v(" "),s("li",[t._v("Total tracks: "+t._s(t.totalTracks))])]),t._v(" "),s("h3",{ref:"detailsHeader",staticClass:"listItem__details-header",attrs:{tabindex:"0"},on:{click:function(e){t.getAlbumDetails(),t.displayDetails=!t.displayDetails},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$refs.detailsHeader.click()}}},[t._v("\n            "+t._s(t.displayDetails&&t.albumDetailsLoaded?"Less":"More")+" information\n            "),s("div",{staticClass:"listItem__header-arrow",class:{open:t.displayDetails&&t.albumDetailsLoaded}})]),t._v(" "),t.albumDetailsLoaded?s("ListItemDetails",{attrs:{displayDetails:t.displayDetails,popularity:t.popularity,tracks:t.tracks}}):t._e()],1)])},staticRenderFns:[]};var w={name:"SearchResults",components:{SearchResultsListItem:s("VU/8")(y,b,!1,function(t){s("SKAw")},"data-v-de2be42c",null).exports},data:function(){return{state:c.state}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"searchResults__wrapper"},[s("p",{directives:[{name:"show",rawName:"v-show",value:t.state.noResults,expression:"state.noResults"}]},[t._v("No results found for: "+t._s(t.state.userText))]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:t.state.albums.length>0&&t.state.renderedAlbums.length>0,expression:"state.albums.length > 0 &&\n        state.renderedAlbums.length > 0"}]},[t._v("\n        "+t._s(t.state.albums.length)+" results found\n    ")]),t._v(" "),s("ul",{staticClass:"searchResults__list"},t._l(t.state.renderedAlbums,function(e){return s("SearchResultsListItem",{key:e.uri,attrs:{id:e.id,img:e.images[1].url,name:e.name,authors:e.artists,date:e.release_date,totalTracks:e.total_tracks.toString(),token:t.state.token}})}),1),t._v(" "),t.state.isLoading?s("div",{staticClass:"loading loading-lg searchResults__loader"}):t._e()])},staticRenderFns:[]};var k=s("VU/8")(w,g,!1,function(t){s("Ebsz")},"data-v-512d6e9b",null).exports,A={name:"ArrowToTop",data:function(){return{arrowDisplay:!1}},methods:{changeArrowDisplay:function(){window.scrollY>500?this.arrowDisplay=!0:this.arrowDisplay=!1},moveToTop:function(){var t=window.scrollY,e=Math.floor(t/50),s=setInterval(function(){window.scrollBy(0,-e),(t-=e)<=0&&clearInterval(s)},10)}},mounted:function(){window.addEventListener("scroll",this.changeArrowDisplay,!1)},beforeDestroy:function(){window.removeEventListener("scroll",this.changeArrowDisplay)}},T={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:t.arrowDisplay,expression:"arrowDisplay"}],ref:"arrow",staticClass:"arrowToTop",attrs:{tabindex:"0"},on:{click:t.moveToTop,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$refs.arrow.click()}}})},staticRenderFns:[]};var R=s("VU/8")(A,T,!1,function(t){s("Yuek")},"data-v-43fe9db7",null).exports,C={name:"RedirectionPopUp",props:{info:{type:String,default:"Redirecting.. please wait"}}},x={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pop-up"},[e("div",{staticClass:"pop-up__wrapper"},[this._m(0),this._v(" "),e("p",{staticClass:"pop-up__text"},[this._v(this._s(this.info))])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pop-up__loader-wrapper"},[e("div",{staticClass:"pop-up__loader-dot"}),this._v(" "),e("div",{staticClass:"pop-up__loader-dot"}),this._v(" "),e("div",{staticClass:"pop-up__loader-dot"})])}]};var D={name:"App",components:{Form:m,SearchResults:k,ArrowToTop:R,RedirectionPopUp:s("VU/8")(C,x,!1,function(t){s("+9c6")},"data-v-3886d5a9",null).exports},data:function(){return{state:c.state}},methods:{renderAlbums:function(){Math.floor(window.innerHeight+window.scrollY)+1>=document.body.offsetHeight&&c.renderAlbums()}},mounted:function(){c.getAuthorization(),window.addEventListener("scroll",this.renderAlbums)},beforeDestroy:function(){window.removeEventListener("scroll",this.renderAlbums)}},E={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("h1",{staticClass:"appHeader"},[this._v("Spotify albums search")]),this._v(" "),e("Form"),this._v(" "),e("SearchResults"),this._v(" "),e("ArrowToTop"),this._v(" "),this.state.displayRedirection?e("RedirectionPopUp",{attrs:{info:"Redirecting to Spotify Authorization"}}):this._e()],1)},staticRenderFns:[]};var L=s("VU/8")(D,E,!1,function(t){s("DwFz")},"data-v-1500168e",null).exports;a.a.config.productionTip=!1,new a.a({el:"#app",render:function(t){return t(L)}})},Rrl4:function(t,e){},SKAw:function(t,e){},Yuek:function(t,e){},ydsG:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.4c47c3a38ee8a5125361.js.map